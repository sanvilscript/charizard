# ==============================================================================
#   CHARIZARD DNS - Unbound Configuration
#   Recursive resolver with DNSSEC
# ==============================================================================

server:
    # Network
    interface: 0.0.0.0
    port: 53
    do-ip4: yes
    do-ip6: yes
    do-udp: yes
    do-tcp: yes

    # Access control
    access-control: 127.0.0.0/8 allow
    access-control: 10.0.0.0/8 allow
    access-control: 172.16.0.0/12 allow
    access-control: 192.168.0.0/16 allow
    access-control: ::1/128 allow
    access-control: fe80::/10 allow

    # Performance
    num-threads: 2
    msg-cache-slabs: 4
    rrset-cache-slabs: 4
    infra-cache-slabs: 4
    key-cache-slabs: 4
    msg-cache-size: 64m
    rrset-cache-size: 128m
    outgoing-range: 8192
    num-queries-per-thread: 4096
    so-rcvbuf: 4m
    so-sndbuf: 4m

    # Privacy
    hide-identity: yes
    hide-version: yes
    qname-minimisation: yes
    minimal-responses: yes

    # Security - DNSSEC
    auto-trust-anchor-file: "/var/lib/unbound/root.key"
    val-clean-additional: yes
    val-permissive-mode: no
    harden-glue: yes
    harden-dnssec-stripped: yes
    harden-referral-path: yes
    harden-algo-downgrade: yes
    use-caps-for-id: yes

    # Hardening
    harden-below-nxdomain: yes
    harden-large-queries: yes
    harden-short-bufsize: yes
    aggressive-nsec: yes

    # Root hints for recursive resolution
    root-hints: "/etc/unbound/root.hints"

    # Prefetching
    prefetch: yes
    prefetch-key: yes

    # Logging (minimal)
    verbosity: 1
    log-queries: no
    log-replies: no
    log-local-actions: no
    logfile: ""
    use-syslog: no

    # Private addresses (RFC1918)
    private-address: 10.0.0.0/8
    private-address: 172.16.0.0/12
    private-address: 192.168.0.0/16
    private-address: 169.254.0.0/16
    private-address: fd00::/8
    private-address: fe80::/10

    # Local zones
    private-domain: "local"
    private-domain: "lan"
    private-domain: "home"
    local-zone: "local." static
    local-zone: "lan." static
    local-zone: "home." static

    # Include local hosts
    include: "/etc/unbound/unbound.conf.d/*.local"

# Remote control (for flush/reload)
remote-control:
    control-enable: yes
    control-interface: 127.0.0.1
    control-port: 8953
    server-key-file: "/etc/unbound/unbound_server.key"
    server-cert-file: "/etc/unbound/unbound_server.pem"
    control-key-file: "/etc/unbound/unbound_control.key"
    control-cert-file: "/etc/unbound/unbound_control.pem"
